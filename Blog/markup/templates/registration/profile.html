{% extends 'base.jinja2' %}

{% block title %}{{_('Личный кабинет')}}{% endblock title %}

{% load static %}

{% block content %}
    <div class="row">
        <div class="container col col-lg-9 col-md-8 col-sm-12 offset-1 p-3 border">
        <!-- информация пользователя -->
            <img src="{% if request.user.photo %}{{ request.user.photo.url }}{% else %}{% static 'media/user_photo/default_user_photo.png' %}{% endif %}" alt="{{ request.user.img_alt }}" class="mr-3 mt-3" style="width:20%;">
            <div style="margin-top: 10px">
                <form action="{% url 'user-change' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="file" name="photo">
                    <p><input class="btn btn-secondary text-black" type="submit" value="{{_('изменить фото')}}"></p>
                </form>
            </div>
            <br>
            <p><strong>{% if request.user.first_name %}{{ request.user.get_full_name }}{% endif %}</strong></p>
            <br>
            <p>email: {{ request.user.email }}</p>
            <br>
        <!-- кнопка перехода для создания статьи -->
            <a href="{% url 'article_create' %}">
                <button class="btn btn-primary text-black" type="button">
                    {{_('новая статья')}}
                </button>
            </a>
            <br>
            <br>
        <!-- статьи пользователя -->
            <div class="container p-3 border">
                <h6>{{_('Мои статьи')}}</h6>
                <hr>
                {% for article in object_list %}
                    <div class="row">
                        <div class="media border p-3" style="margin-bottom: 15px">
                            <div class="media-body">
                                <p>
                                    <a href="{% url 'article_detail' article.slug %}">
                                        {{ article.title }}
                                    </a>
                                </p>
                                <p>{{ article.short_description }}</p>
                                <p class="text-muted">{{_('рейтинг')}} {{ article.average_rating }}</p>
                                <div class="row">
                                    <a href="{% url 'article_update' article.slug %}">
                                        <button class="btn btn-primary text-black" type="button">
                                            {{_('изменить статью')}}
                                        </button>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    <!-- избранные статьи -->
        <div class="container col col-lg-2 col-md-3 col-sm-12">
            <div class="container p-3 border">
                <h6>{{_('Избранные статьи')}}</h6>
                <hr>
                {% for favorite in request.user.favoritesarticle_set.all %}
                    <a href="{% url 'article_detail' favorite.article.slug %}">{{ favorite.article.title }}</a>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}